<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TEV Dashboard â€” åŠ å¯†åè®®ä¼°å€¼</title>
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="../favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Noto+Sans+SC:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #0a0a0b;
      --bg-secondary: #111113;
      --bg-tertiary: #18181b;
      --bg-hover: #1f1f23;
      --border: #27272a;
      --text-primary: #fafafa;
      --text-secondary: #a1a1aa;
      --text-tertiary: #71717a;
      --accent: #22c55e;
      --accent-dim: rgba(34, 197, 94, 0.1);
      --warning: #f59e0b;
      --warning-dim: rgba(245, 158, 11, 0.1);
      --danger: #ef4444;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans SC', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 24px;
    }

    /* Header */
    header {
      border-bottom: 1px solid var(--border);
      padding: 20px 0;
      position: sticky;
      top: 0;
      background: var(--bg-primary);
      z-index: 100;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
    }

    .logo-icon { width: 36px; height: 36px; border-radius: 8px; }

    .logo-text {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .logo-text span {
      color: var(--text-tertiary);
      font-weight: 400;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 24px;
    }

    nav {
      display: flex;
      gap: 32px;
    }

    nav a {
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      transition: color 0.2s;
    }

    nav a:hover, nav a.active {
      color: var(--text-primary);
    }

    /* Language Switcher */
    .lang-switch {
      display: flex;
      background: var(--bg-tertiary);
      border-radius: 6px;
      padding: 2px;
      border: 1px solid var(--border);
    }

    .lang-btn {
      padding: 6px 12px;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.2s;
    }

    .lang-btn.active {
      background: var(--accent);
      color: var(--bg-primary);
    }

    .lang-btn:hover:not(.active) {
      color: var(--text-primary);
    }

    /* Hero */
    .hero {
      padding: 48px 0 32px;
      text-align: center;
    }

    .hero h1 {
      font-size: 42px;
      font-weight: 700;
      letter-spacing: -0.02em;
      margin-bottom: 12px;
      background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero p {
      color: var(--text-secondary);
      font-size: 17px;
      max-width: 700px;
      margin: 0 auto;
    }

    /* Stats Bar */
    .stats-bar {
      display: flex;
      gap: 1px;
      background: var(--border);
      margin: 32px 24px 0;
      border-radius: 12px;
      overflow: hidden;
    }

    .stat-item {
      flex: 1;
      background: var(--bg-secondary);
      padding: 20px 24px;
      text-align: center;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 700;
      font-family: 'JetBrains Mono', monospace;
      letter-spacing: -0.02em;
    }

    .stat-label {
      font-size: 12px;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-top: 4px;
    }

    /* Table */
    .table-section {
      padding: 32px 0 48px;
    }

    .table-container {
      background: var(--bg-secondary);
      border-radius: 12px;
      border: 1px solid var(--border);
      overflow: hidden;
    }

    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 24px;
      border-bottom: 1px solid var(--border);
    }

    .table-title {
      font-weight: 700;
      font-size: 16px;
    }

    .table-filters {
      display: flex;
      gap: 8px;
    }

    .filter-btn {
      padding: 6px 12px;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text-secondary);
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .filter-btn:hover {
      border-color: var(--text-tertiary);
      color: var(--text-primary);
    }

    .filter-btn.active {
      background: var(--accent-dim);
      border-color: var(--accent);
      color: var(--accent);
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 16px 24px;
      text-align: left;
    }

    th {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 1px solid var(--border);
    }

    th.sortable {
      cursor: pointer;
      user-select: none;
      transition: color 0.15s;
    }
    th.sortable:hover {
      color: var(--accent);
    }
    th.sortable::after {
      content: '';
      margin-left: 4px;
      opacity: 0.3;
    }
    th.sortable.sorted::after {
      opacity: 1;
    }
    th.sortable.sorted.asc::after {
      content: ' â†‘';
    }
    th.sortable.sorted.desc::after {
      content: ' â†“';
    }
    th.sorted {
      color: var(--accent);
    }

    tr {
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      transition: background 0.2s;
    }

    tr:hover {
      background: var(--bg-hover);
    }

    tr:last-child {
      border-bottom: none;
    }

    .text-right {
      text-align: right;
    }

    .protocol-cell {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .protocol-icon {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      background: var(--bg-tertiary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      overflow: hidden;
    }

    .protocol-icon img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .protocol-info {
      display: flex;
      flex-direction: column;
    }

    .protocol-name {
      font-weight: 700;
      font-size: 14px;
    }

    .protocol-ticker {
      font-size: 12px;
      color: var(--text-tertiary);
    }

    .value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
    }

    .value-highlight {
      color: var(--accent);
      font-weight: 700;
    }

    .value-zero {
      color: var(--text-tertiary);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 500;
    }

    .badge-high {
      background: var(--accent-dim);
      color: var(--accent);
    }

    .badge-medium {
      background: var(--warning-dim);
      color: var(--warning);
    }

    .badge-low {
      background: rgba(239, 68, 68, 0.1);
      color: var(--danger);
    }

    .badge-active {
      background: var(--accent-dim);
      color: var(--accent);
    }

    .badge-partial {
      background: var(--warning-dim);
      color: var(--warning);
    }

    .badge-none {
      background: rgba(113, 113, 122, 0.1);
      color: var(--text-tertiary);
    }

    /* Loading State */
    .loading {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-tertiary);
    }

    .loading-spinner {
      width: 32px;
      height: 32px;
      border: 3px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 16px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Intro Section */
    .intro-section {
      padding: 48px 0;
      border-top: 1px solid var(--border);
    }

    .intro-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
      align-items: start;
    }

    .intro-card {
      background: var(--bg-secondary);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 28px;
    }

    .intro-card h2 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .intro-card h2 .icon {
      font-size: 22px;
    }

    .intro-card p {
      color: var(--text-secondary);
      font-size: 14px;
      line-height: 1.8;
      margin-bottom: 14px;
    }

    .intro-card p:last-child {
      margin-bottom: 0;
    }

    .formula-box {
      background: var(--bg-tertiary);
      border-radius: 8px;
      padding: 14px 18px;
      margin: 14px 0;
      font-family: 'JetBrains Mono', monospace;
      font-size: 13px;
      color: var(--accent);
      text-align: center;
    }

    /* Author & Video Section */
    .author-video-section {
      padding: 48px 0;
      border-top: 1px solid var(--border);
    }

    .author-video-grid {
      display: grid;
      grid-template-columns: 1fr 1.2fr;
      gap: 32px;
      align-items: start;
    }

    .author-card {
      background: var(--bg-secondary);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 28px;
    }

    .author-header {
      display: flex;
      gap: 20px;
      align-items: center;
      margin-bottom: 16px;
    }

    .author-avatar {
      width: 72px;
      height: 72px;
      background: linear-gradient(135deg, var(--accent) 0%, #059669 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      flex-shrink: 0;
    }

    .author-meta h3 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .author-meta .tagline {
      color: var(--accent);
      font-size: 13px;
      font-weight: 500;
    }

    .author-bio {
      color: var(--text-secondary);
      font-size: 14px;
      line-height: 1.8;
      margin-bottom: 16px;
    }

    .author-links {
      display: flex;
      gap: 10px;
    }

    .author-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 13px;
      transition: all 0.2s;
    }

    .author-link:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .video-card {
      background: var(--bg-secondary);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 28px;
    }

    .video-card h2 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
    }

    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      border-radius: 10px;
      border: 1px solid var(--border);
    }

    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    /* YouTube Banner */
    .yt-banner {
      padding: 48px 0;
      background: linear-gradient(135deg, #1a1a1d 0%, #0f0f10 100%);
      border-top: 1px solid var(--border);
    }

    .yt-banner-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 32px;
      max-width: 900px;
      margin: 0 auto;
      padding: 32px 40px;
      background: linear-gradient(135deg, rgba(255,0,0,0.08) 0%, rgba(255,0,0,0.02) 100%);
      border: 1px solid rgba(255,0,0,0.2);
      border-radius: 16px;
    }

    .yt-banner-icon {
      color: #ff0000;
      flex-shrink: 0;
    }

    .yt-banner-text {
      flex: 1;
    }

    .yt-banner-text h3 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .yt-banner-text p {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .yt-banner-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 28px;
      background: #ff0000;
      color: white;
      text-decoration: none;
      font-size: 15px;
      font-weight: 700;
      border-radius: 8px;
      transition: all 0.2s;
      flex-shrink: 0;
    }

    .yt-banner-btn:hover {
      background: #cc0000;
      transform: translateY(-2px);
    }

    @media (max-width: 768px) {
      .yt-banner-content {
        flex-direction: column;
        text-align: center;
        padding: 24px;
        gap: 20px;
      }
    }

    /* Footer */
    footer {
      margin-top: 48px;
      padding: 24px 0;
      border-top: 1px solid var(--border);
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .footer-text {
      font-size: 13px;
      color: var(--text-tertiary);
    }

    .footer-links {
      display: flex;
      gap: 24px;
    }

    .footer-links a {
      font-size: 13px;
      color: var(--text-secondary);
      text-decoration: none;
      transition: color 0.2s;
    }

    .footer-links a:hover {
      color: var(--text-primary);
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .intro-grid, .author-video-grid {
        grid-template-columns: 1fr;
      }

      .stats-bar {
        flex-wrap: wrap;
      }

      .stat-item {
        flex: 1 1 50%;
      }
    }

    @media (max-width: 768px) {
      nav {
        display: none;
      }

      .hero h1 {
        font-size: 28px;
      }

      .hero p {
        font-size: 15px;
      }

      .author-header {
        flex-direction: column;
        text-align: center;
      }

      .author-links {
        justify-content: center;
        flex-wrap: wrap;
      }

      .table-container {
        overflow-x: auto;
      }

      table {
        min-width: 900px;
      }

      th, td {
        padding: 12px 16px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <a href="../" class="logo">
          <img src="../logo.svg" alt="3D" class="logo-icon">
          <span class="logo-text">Crypto3D</span>
        </a>
        <div class="header-right">
          <nav>
            <a href="../" data-i18n="nav.home">â† é¦–é¡µ</a>
            <a href="#protocols" class="active" data-i18n="nav.protocols">åè®®æ•°æ®</a>
            <a href="#methodology" data-i18n="nav.methodology">æ–¹æ³•è®º</a>
            <a href="#about" data-i18n="nav.about">å…³äº</a>
          </nav>
          <div class="lang-switch">
            <button class="lang-btn active" data-lang="zh">ä¸­æ–‡</button>
            <button class="lang-btn" data-lang="en">EN</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container">
        <h1 data-i18n="hero.title">åŠ å¯†åè®®ä¼°å€¼ä»ªè¡¨ç›˜</h1>
        <p data-i18n="hero.subtitle">è¿½è¸ªåè®®æ”¶å…¥çœŸæ­£æµå‘ä»£å¸æŒæœ‰è€…çš„æ¯”ä¾‹ã€‚TEV Yield æ˜¯åŠ å¯†ç‰ˆçš„ã€Œè‚¡æ¯ç‡ã€ã€‚</p>
      </div>
    </section>

    <section class="stats-bar">
      <div class="stat-item">
        <div class="stat-value" id="stat-protocols">â€”</div>
        <div class="stat-label" data-i18n="stats.protocols">è¿½è¸ªåè®®æ•°</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="stat-mcap">â€”</div>
        <div class="stat-label" data-i18n="stats.mcap">æ€»å¸‚å€¼</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="stat-fees">â€”</div>
        <div class="stat-label" data-i18n="stats.fees">30æ—¥æ€»è´¹ç”¨</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="stat-tev">â€”</div>
        <div class="stat-label" data-i18n="stats.tev">30æ—¥æ€» TEV</div>
      </div>
    </section>

    <section class="table-section" id="protocols">
      <div class="container">
        <div class="table-container">
          <div class="table-header">
            <div class="table-title" data-i18n="table.title">åè®®æ’å</div>
            <div class="table-filters">
              <button class="filter-btn active" data-filter="all" data-i18n="filter.all">å…¨éƒ¨</button>
              <button class="filter-btn" data-filter="lending" data-i18n="filter.lending">å€Ÿè´·</button>
              <button class="filter-btn" data-filter="dex" data-i18n="filter.dex">DEX</button>
              <button class="filter-btn" data-filter="cex" data-i18n="filter.cex">CEX</button>
              <button class="filter-btn" data-filter="perpetuals" data-i18n="filter.perps">Perps</button>
              <button class="filter-btn" data-filter="yield" data-i18n="filter.yield">æ”¶ç›Š</button>
            </div>
          </div>
          <div id="table-loading" class="loading">
            <div class="loading-spinner"></div>
            <div data-i18n="table.loading">åŠ è½½åè®®æ•°æ®ä¸­...</div>
          </div>
          <table id="protocol-table" style="display: none;">
            <thead>
              <tr>
                <th style="width: 50px;">#</th>
                <th data-i18n="th.protocol">åè®®</th>
                <th class="text-right sortable" data-sort="tvl" data-i18n="th.tvl">TVL</th>
                <th class="text-right sortable sorted desc" data-sort="tevStatus" data-i18n="th.tevStatus">TEV çŠ¶æ€</th>
                <th class="text-right sortable" data-sort="tevRatio" data-i18n="th.tevRatio">åˆ†é…æ¯”ä¾‹</th>
                <th class="text-right sortable" data-sort="mcap" data-i18n="th.mcap">å¸‚å€¼</th>
                <th class="text-right sortable" data-sort="earningYield" data-i18n="th.earningYield">æ”¶ç›Šç‡</th>
                <th class="text-right sortable" data-sort="tevYield" data-i18n="th.yield">TEV Yield</th>
                <th class="text-right" data-i18n="th.confidence">å¯ä¿¡åº¦</th>
              </tr>
            </thead>
            <tbody id="protocol-tbody">
            </tbody>
          </table>
          <div class="data-update-time" id="data-update-time" data-i18n="table.updateTime" style="font-size: 12px; color: var(--text-tertiary); text-align: right; margin-top: 12px; font-family: 'JetBrains Mono', monospace;">æ•°æ®æ›´æ–°: â€”</div>
        </div>
      </div>
    </section>

    <section class="intro-section" id="methodology">
      <div class="container">
        <div class="intro-grid">
          <div class="intro-card">
            <h2><span class="icon">ğŸ“Š</span> <span data-i18n="intro.what.title">ä»€ä¹ˆæ˜¯ TEV?</span></h2>
            <p data-i18n="intro.what.p1">
              <strong>TEV (Token Empowerment Value)</strong>ï¼Œå³ã€Œä»£å¸èµ‹èƒ½ä»·å€¼ã€ï¼Œæ˜¯è¡¡é‡åŠ å¯†åè®®å‘ä»£å¸æŒæœ‰è€…åˆ†é…ä»·å€¼èƒ½åŠ›çš„æ ¸å¿ƒæŒ‡æ ‡ã€‚
            </p>
            <p data-i18n="intro.what.p2">
              ä¸åŒäºä¼ ç»Ÿçš„ã€Œåè®®æ”¶å…¥ã€ï¼ŒTEV åªè®¡ç®—çœŸæ­£èµ‹èƒ½ç»™ä»£å¸æŒæœ‰è€…çš„é‚£éƒ¨åˆ†â€”â€”åŒ…æ‹¬å›è´­é”€æ¯ã€è´¨æŠ¼åˆ†çº¢ã€æ²»ç†æ¿€åŠ±ç­‰ã€‚
            </p>
            <div class="formula-box">
              TEV Yield = TEV Ã· Market Cap Ã— 100%
            </div>
            <p data-i18n="intro.what.p3">
              è¿™ä¸ªæ¯”ç‡ç±»ä¼¼ä¼ ç»Ÿè‚¡ç¥¨çš„ã€Œè‚¡æ¯ç‡ã€ï¼Œå¸®åŠ©æŠ•èµ„è€…ç”¨è‚¡ä¸œå›æŠ¥è§†è§’è¯„ä¼°åè®®ä»·å€¼ã€‚
            </p>
          </div>
          <div class="intro-card">
            <h2><span class="icon">ğŸ’¡</span> <span data-i18n="intro.why.title">ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªæŒ‡æ ‡?</span></h2>
            <p data-i18n="intro.why.p1">
              åŠ å¯†è¡Œä¸šå‘å±•äº†è¿™ä¹ˆå¤šå¹´ï¼Œå¤§éƒ¨åˆ† Token ä¾ç„¶æ˜¯ã€Œç©ºæ°”ã€â€”â€”æŒæœ‰å®ƒä»¬é™¤äº†æŠ•æœºï¼Œå‡ ä¹æ²¡æœ‰ä»»ä½•å®é™…ä»·å€¼ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šå¤šçš„æŠ•èµ„è€…å¯¹ã€ŒæŒå¸ã€å¤±å»ä¿¡å¿ƒã€‚
            </p>
            <p data-i18n="intro.why.p2">
              ä½†å¹¶éæ‰€æœ‰é¡¹ç›®éƒ½æ˜¯å¦‚æ­¤ã€‚ä¸€äº›çœŸæ­£ä¼˜ç§€çš„åŠ å¯†åè®®ï¼Œæ­£åœ¨é€šè¿‡å›è´­ã€åˆ†çº¢ã€é”€æ¯ç­‰æ–¹å¼ï¼Œå°†åè®®æ”¶å…¥å›é¦ˆç»™ä»£å¸æŒæœ‰è€…â€”â€”è¿™æ‰æ˜¯ã€ŒæŒå¸è€…æƒç›Šã€åº”æœ‰çš„æ ·å­ã€‚
            </p>
            <p data-i18n="intro.why.p3">
              TEV æŒ‡æ ‡çš„æ ¸å¿ƒç›®æ ‡ï¼Œå°±æ˜¯å¸®ä½ ç­›é€‰å‡ºé‚£äº›çœŸæ­£åœ¨ä¸ºæŒå¸è€…åˆ›é€ ä»·å€¼çš„åè®®ï¼Œè€Œä¸æ˜¯åªä¼šç”»é¥¼çš„ã€Œç©ºæ°”é¡¹ç›®ã€ã€‚ç”¨æ•°æ®è¯´è¯ï¼Œè®©èµ‹èƒ½å¯é‡åŒ–ã€‚
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="author-video-section" id="about">
      <div class="container">
        <div class="author-video-grid">
          <div class="author-card">
            <div class="author-header">
              <div class="author-avatar">ğŸ”®</div>
              <div class="author-meta">
                <h3>3D</h3>
                <div class="tagline" data-i18n="author.tagline">DeFi å®æˆ˜æ´¾ | TEV æ¡†æ¶åˆ›å»ºè€…</div>
              </div>
            </div>
            <p class="author-bio" data-i18n="author.bio">
              ä¸“æ³¨ DeFiã€é“¾ä¸Šå¥—åˆ©åŠä½é£é™©æœºä¼šçš„æ¢ç´¢ä¸å®æˆ˜ã€‚TEVï¼ˆä»£å¸èµ‹èƒ½ä»·å€¼ï¼‰æŒ‡æ ‡ä½“ç³»æ˜¯æˆ‘åœ¨å®è·µä¸­æç‚¼çš„ä¼°å€¼æ¡†æ¶â€”â€”ç”¨ã€Œè‚¡ä¸œå›æŠ¥ã€è§†è§’å®¡è§†åŠ å¯†é¡¹ç›®ï¼ŒåŒºåˆ†çœŸæ­£å›é¦ˆæŒå¸è€…çš„ä¼˜è´¨åè®®å’Œåªä¼šç”»é¥¼çš„ç©ºæ°”é¡¹ç›®ã€‚ç›¸ä¿¡ã€Œæ´»å¾—ä¹…ã€æ¯”ã€Œèµšå¾—å¤šã€æ›´é‡è¦ï¼Œå¸Œæœ›è¿™ä¸ªå·¥å…·èƒ½å¸®åŠ©æ›´å¤šäººåšå‡ºç†æ€§æŠ•èµ„å†³ç­–ã€‚æˆ‘åœ¨ YouTubeã€Œ3D åŠ å¯†é¢‘é“ã€æŒç»­åˆ†äº« DeFi ç ”ç©¶å’Œå®æˆ˜å¿ƒå¾—ï¼Œæ¬¢è¿è®¢é˜…äº¤æµã€‚
            </p>
            <div class="author-links">
              <a href="https://x.com/22333D" target="_blank" class="author-link">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                <span>@22333D</span>
              </a>
              <a href="https://www.youtube.com/@Crypto36D" target="_blank" class="author-link">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
                <span data-i18n="author.youtube">3D åŠ å¯†é¢‘é“</span>
              </a>
            </div>
          </div>
          <div class="video-card">
            <h2 data-i18n="video.title">ğŸ“º TEV æ¡†æ¶è¯¦è§£</h2>
            <div class="video-container">
              <iframe 
                src="https://www.youtube.com/embed/Gl8e_t2Zo6w" 
                title="TEV Framework Explained"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen>
              </iframe>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- YouTube CTA Banner -->
  <section class="yt-banner">
    <div class="container">
      <div class="yt-banner-content">
        <div class="yt-banner-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
        </div>
        <div class="yt-banner-text">
          <h3 data-i18n="ytbanner.title">ğŸ“º è®¢é˜… 3D åŠ å¯†é¢‘é“</h3>
          <p data-i18n="ytbanner.desc">æ›´å¤š DeFi æ·±åº¦åˆ†æã€é“¾ä¸Šå¥—åˆ©å®æˆ˜ã€ä½é£é™©æœºä¼šåˆ†äº«ï¼Œå°½åœ¨ YouTube</p>
        </div>
        <a href="https://www.youtube.com/@Crypto36D?sub_confirmation=1" target="_blank" class="yt-banner-btn" data-i18n="ytbanner.btn">ç«‹å³è®¢é˜…</a>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-text" id="footer-updated" data-i18n="footer.loading">
          åŠ è½½æ•°æ®ä¸­...
        </div>
        <div class="footer-links">
          <a href="#methodology" data-i18n="footer.methodology">æ–¹æ³•è®º</a>
          <a href="#" data-i18n="footer.sources">æ•°æ®æ¥æº</a>
          <a href="https://github.com" target="_blank">GitHub</a>
          <a href="https://x.com/22333D" target="_blank">@22333D</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // ============================================
    // i18n System
    // ============================================
    const i18n = {
      zh: {
        'nav.home': 'â† é¦–é¡µ',
        'nav.protocols': 'åè®®æ•°æ®',
        'nav.methodology': 'æ–¹æ³•è®º',
        'nav.about': 'å…³äº',
        'hero.title': 'åŠ å¯†åè®®ä¼°å€¼ä»ªè¡¨ç›˜',
        'hero.subtitle': 'è¿½è¸ªåè®®æ”¶å…¥çœŸæ­£æµå‘ä»£å¸æŒæœ‰è€…çš„æ¯”ä¾‹ã€‚TEV Yield æ˜¯åŠ å¯†ç‰ˆçš„ã€Œè‚¡æ¯ç‡ã€ã€‚',
        'intro.what.title': 'ä»€ä¹ˆæ˜¯ TEV?',
        'intro.what.p1': '<strong>TEV (Token Empowerment Value)</strong>ï¼Œå³ã€Œä»£å¸èµ‹èƒ½ä»·å€¼ã€ï¼Œæ˜¯è¡¡é‡åŠ å¯†åè®®å‘ä»£å¸æŒæœ‰è€…åˆ†é…ä»·å€¼èƒ½åŠ›çš„æ ¸å¿ƒæŒ‡æ ‡ã€‚',
        'intro.what.p2': 'ä¸åŒäºä¼ ç»Ÿçš„ã€Œåè®®æ”¶å…¥ã€ï¼ŒTEV åªè®¡ç®—çœŸæ­£èµ‹èƒ½ç»™ä»£å¸æŒæœ‰è€…çš„é‚£éƒ¨åˆ†â€”â€”åŒ…æ‹¬å›è´­é”€æ¯ã€è´¨æŠ¼åˆ†çº¢ã€æ²»ç†æ¿€åŠ±ç­‰ã€‚',
        'intro.what.p3': 'è¿™ä¸ªæ¯”ç‡ç±»ä¼¼ä¼ ç»Ÿè‚¡ç¥¨çš„ã€Œè‚¡æ¯ç‡ã€ï¼Œå¸®åŠ©æŠ•èµ„è€…ç”¨è‚¡ä¸œå›æŠ¥è§†è§’è¯„ä¼°åè®®ä»·å€¼ã€‚',
        'intro.why.title': 'ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªæŒ‡æ ‡?',
        'intro.why.p1': 'åŠ å¯†è¡Œä¸šå‘å±•äº†è¿™ä¹ˆå¤šå¹´ï¼Œå¤§éƒ¨åˆ† Token ä¾ç„¶æ˜¯ã€Œç©ºæ°”ã€â€”â€”æŒæœ‰å®ƒä»¬é™¤äº†æŠ•æœºï¼Œå‡ ä¹æ²¡æœ‰ä»»ä½•å®é™…ä»·å€¼ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šå¤šçš„æŠ•èµ„è€…å¯¹ã€ŒæŒå¸ã€å¤±å»ä¿¡å¿ƒã€‚',
        'intro.why.p2': 'ä½†å¹¶éæ‰€æœ‰é¡¹ç›®éƒ½æ˜¯å¦‚æ­¤ã€‚ä¸€äº›çœŸæ­£ä¼˜ç§€çš„åŠ å¯†åè®®ï¼Œæ­£åœ¨é€šè¿‡å›è´­ã€åˆ†çº¢ã€é”€æ¯ç­‰æ–¹å¼ï¼Œå°†åè®®æ”¶å…¥å›é¦ˆç»™ä»£å¸æŒæœ‰è€…â€”â€”è¿™æ‰æ˜¯ã€ŒæŒå¸è€…æƒç›Šã€åº”æœ‰çš„æ ·å­ã€‚',
        'intro.why.p3': 'TEV æŒ‡æ ‡çš„æ ¸å¿ƒç›®æ ‡ï¼Œå°±æ˜¯å¸®ä½ ç­›é€‰å‡ºé‚£äº›çœŸæ­£åœ¨ä¸ºæŒå¸è€…åˆ›é€ ä»·å€¼çš„åè®®ï¼Œè€Œä¸æ˜¯åªä¼šç”»é¥¼çš„ã€Œç©ºæ°”é¡¹ç›®ã€ã€‚ç”¨æ•°æ®è¯´è¯ï¼Œè®©èµ‹èƒ½å¯é‡åŒ–ã€‚',
        'video.title': 'ğŸ“º TEV æ¡†æ¶è¯¦è§£',
        'author.tagline': 'DeFi å®æˆ˜æ´¾ | TEV æ¡†æ¶åˆ›å»ºè€…',
        'author.bio': 'ä¸“æ³¨ DeFiã€é“¾ä¸Šå¥—åˆ©åŠä½é£é™©æœºä¼šçš„æ¢ç´¢ä¸å®æˆ˜ã€‚TEVï¼ˆä»£å¸èµ‹èƒ½ä»·å€¼ï¼‰æŒ‡æ ‡ä½“ç³»æ˜¯æˆ‘åœ¨å®è·µä¸­æç‚¼çš„ä¼°å€¼æ¡†æ¶â€”â€”ç”¨ã€Œè‚¡ä¸œå›æŠ¥ã€è§†è§’å®¡è§†åŠ å¯†é¡¹ç›®ï¼ŒåŒºåˆ†çœŸæ­£å›é¦ˆæŒå¸è€…çš„ä¼˜è´¨åè®®å’Œåªä¼šç”»é¥¼çš„ç©ºæ°”é¡¹ç›®ã€‚ç›¸ä¿¡ã€Œæ´»å¾—ä¹…ã€æ¯”ã€Œèµšå¾—å¤šã€æ›´é‡è¦ï¼Œå¸Œæœ›è¿™ä¸ªå·¥å…·èƒ½å¸®åŠ©æ›´å¤šäººåšå‡ºç†æ€§æŠ•èµ„å†³ç­–ã€‚æˆ‘åœ¨ YouTubeã€Œ3D åŠ å¯†é¢‘é“ã€æŒç»­åˆ†äº« DeFi ç ”ç©¶å’Œå®æˆ˜å¿ƒå¾—ï¼Œæ¬¢è¿è®¢é˜…äº¤æµã€‚',
        'author.youtube': '3D åŠ å¯†é¢‘é“',
        'stats.protocols': 'è¿½è¸ªåè®®æ•°',
        'stats.mcap': 'æ€»å¸‚å€¼',
        'stats.fees': '30æ—¥æ€»è´¹ç”¨',
        'stats.tev': '30æ—¥æ€» TEV',
        'table.title': 'åè®®æ’å',
        'table.loading': 'åŠ è½½åè®®æ•°æ®ä¸­...',
        'filter.all': 'å…¨éƒ¨',
        'filter.lending': 'å€Ÿè´·',
        'filter.dex': 'DEX',
        'filter.cex': 'CEX',
        'filter.perps': 'Perps',
        'filter.yield': 'æ”¶ç›Š',
        'th.protocol': 'åè®®',
        'th.earningYield': 'æ”¶ç›Šç‡',
        'th.tvl': 'TVL',
        'th.tevStatus': 'TEV çŠ¶æ€',
        'th.tevRatio': 'åˆ†é…æ¯”ä¾‹',
        'th.mcap': 'å¸‚å€¼',
        'th.price': 'ä»·æ ¼',
        'th.fees': '30æ—¥è´¹ç”¨',
        'th.tev': '30æ—¥ TEV',
        'th.yield': 'TEV Yield',
        'th.days': 'æ•°æ®å¤©æ•°',
        'th.confidence': 'å¯ä¿¡åº¦',
        'tevStatus.active': 'æ´»è·ƒ',
        'tevStatus.partial': 'éƒ¨åˆ†',
        'tevStatus.none': 'æ— ',
        'confidence.high': 'é«˜',
        'confidence.medium': 'ä¸­',
        'confidence.low': 'ä½',
        'footer.loading': 'åŠ è½½æ•°æ®ä¸­...',
        'footer.updated': 'æ•°æ®æ›´æ–°æ—¶é—´ï¼š{date} Â· ç»´æŠ¤è€… 3D',
        'footer.methodology': 'æ–¹æ³•è®º',
        'footer.sources': 'æ•°æ®æ¥æº',
        'ytbanner.title': 'ğŸ“º è®¢é˜… 3D åŠ å¯†é¢‘é“',
        'ytbanner.desc': 'æ›´å¤š DeFi æ·±åº¦åˆ†æã€é“¾ä¸Šå¥—åˆ©å®æˆ˜ã€ä½é£é™©æœºä¼šåˆ†äº«ï¼Œå°½åœ¨ YouTube',
        'ytbanner.btn': 'ç«‹å³è®¢é˜…',
      },
      en: {
        'nav.home': 'â† Home',
        'nav.protocols': 'Protocols',
        'nav.methodology': 'Methodology',
        'nav.about': 'About',
        'hero.title': 'Crypto Protocol Valuation Dashboard',
        'hero.subtitle': 'Track how much protocol revenue actually flows to token holders. TEV Yield is the dividend yield for crypto.',
        'intro.what.title': 'What is TEV?',
        'intro.what.p1': '<strong>TEV (Token Empowerment Value)</strong> measures how much value a crypto protocol distributes to its token holders.',
        'intro.what.p2': 'Unlike "protocol revenue", TEV only counts value that actually empowers token holders â€” including buybacks, staking rewards, and governance incentives.',
        'intro.what.p3': 'This ratio is similar to traditional dividend yield, helping investors evaluate protocols from a shareholder return perspective.',
        'intro.why.title': 'Why This Metric?',
        'intro.why.p1': 'After years of crypto evolution, most tokens remain "vaporware" â€” holding them offers nothing beyond speculation. That\'s why more investors are losing faith in "holding tokens."',
        'intro.why.p2': 'But not all projects are the same. Some truly excellent DeFi protocols are giving back to token holders through buybacks, dividends, and burns â€” this is what "token holder equity" should look like.',
        'intro.why.p3': 'The core goal of TEV is to help you identify protocols that genuinely create value for holders, not just projects that make empty promises. Let data speak, make empowerment measurable.',
        'video.title': 'ğŸ“º TEV Framework Explained',
        'author.tagline': 'DeFi Practitioner | TEV Framework Creator',
        'author.bio': 'Focused on DeFi, on-chain arbitrage, and low-risk opportunities. The TEV (Token Empowerment Value) framework is a valuation system I developed to evaluate crypto projects from a shareholder return perspective â€” distinguishing protocols that genuinely reward token holders from those that only make empty promises. I believe "staying alive" matters more than "getting rich quick," and hope this tool helps more people make rational investment decisions. Subscribe to my YouTube channel "3D Crypto" for DeFi research and insights.',
        'author.youtube': '3D Crypto Channel',
        'stats.protocols': 'Protocols Tracked',
        'stats.mcap': 'Total Market Cap',
        'stats.fees': '30d Total Fees',
        'stats.tev': '30d Total TEV',
        'table.title': 'Protocol Rankings',
        'table.loading': 'Loading protocol data...',
        'filter.all': 'All',
        'filter.lending': 'Lending',
        'filter.dex': 'DEX',
        'filter.cex': 'CEX',
        'filter.perps': 'Perps',
        'filter.yield': 'Yield',
        'th.protocol': 'Protocol',
        'th.earningYield': 'Earning Yield',
        'th.tvl': 'TVL',
        'th.tevStatus': 'TEV Status',
        'th.tevRatio': 'Distribution',
        'th.mcap': 'Market Cap',
        'th.price': 'Price',
        'th.fees': '30d Fees',
        'th.tev': '30d TEV',
        'th.yield': 'TEV Yield',
        'th.days': 'Data Days',
        'th.confidence': 'Confidence',
        'tevStatus.active': 'Active',
        'tevStatus.partial': 'Partial',
        'tevStatus.none': 'None',
        'confidence.high': 'High',
        'confidence.medium': 'Medium',
        'confidence.low': 'Low',
        'footer.loading': 'Loading data...',
        'footer.updated': 'Data updated: {date} Â· Maintained by 3D',
        'footer.methodology': 'Methodology',
        'footer.sources': 'Data Sources',
        'ytbanner.title': 'ğŸ“º Subscribe to 3D Crypto Channel',
        'ytbanner.desc': 'More DeFi deep dives, on-chain arbitrage tactics, and low-risk opportunities on YouTube',
        'ytbanner.btn': 'Subscribe Now',
      }
    };

    let currentLang = 'zh';

    function t(key) {
      return i18n[currentLang][key] || key;
    }

    function setLanguage(lang) {
      currentLang = lang;
      document.documentElement.lang = lang === 'zh' ? 'zh-CN' : 'en';
      
      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === lang);
      });
      
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.dataset.i18n;
        const translation = t(key);
        if (translation) {
          el.innerHTML = translation;
        }
      });

      if (window.protocolData) {
        renderTable(window.protocolData);
        updateFooter(window.protocolData);
      }
    }

    // ============================================
    // Logo URLs - loaded dynamically
    let LOGO_URLS = {};

    // Protocol Data - åŠ¨æ€åŠ è½½
    // ============================================
    let PROTOCOLS = {}; // ä» all-protocols.json åŠ è½½

    // ä¸´æ—¶å…¼å®¹ï¼šä¿ç•™ aave å®šä¹‰é˜²æ­¢æŠ¥é”™ï¼Œåé¢ä¼šè¢«è¦†ç›–
    const PROTOCOLS_PLACEHOLDER = {
      aave: {
        name: 'Aave',
        ticker: 'AAVE',
        icon: 'https://coin-images.coingecko.com/coins/images/12645/large/aave-token-round.png',
        category: 'lending',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.318,
        tvl: 29600000000,
      },
      lido: {
        name: 'Lido',
        ticker: 'LDO',
        icon: 'https://coin-images.coingecko.com/coins/images/13573/large/Lido_DAO.png',
        category: 'liquid_staking',
        confidence: 'high',
        tevStatus: 'none',
        tevRatio: 0,
        tvl: 20453052897,
        note: 'Fee switch OFF - governance only'
      },
      eigenlayer: {
        name: 'EigenLayer',
        ticker: 'EIGEN',
        icon: 'https://coin-images.coingecko.com/coins/images/37441/large/eigenlayer.png',
        category: 'restaking',
        confidence: 'high',
        tevStatus: 'none',
        tevRatio: 0,
        tvl: 9710144847,
        note: 'Fee switch OFF - governance only'
      },
      etherfi: {
        name: 'ether.fi',
        ticker: 'ETHFI',
        icon: 'https://coin-images.coingecko.com/coins/images/35958/large/etherfi.jpeg',
        category: 'liquid_staking',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: null,
        tvl: 6394743902,
        note: 'æç°æ”¶å…¥ç”¨äºå›è´­ï¼ŒTEV yield ~5.69%'
      },
      ethena: {
        name: 'Ethena',
        ticker: 'ENA',
        icon: 'https://coin-images.coingecko.com/coins/images/36530/large/ethena.png',
        category: 'yield',
        confidence: 'medium',
        tevStatus: 'partial',
        tevRatio: null,
        tvl: 6535353327,
        note: 'æ”¶ç›Šä¸»è¦åˆ†é…ç»™ sUSDe (APY ~7.83%)ï¼ŒsENA è·å¾—éƒ¨åˆ†æ”¶ç›Šä½†æ¯”ä¾‹ä¸å…¬å¼€'
      },
      morpho: {
        name: 'Morpho',
        ticker: 'MORPHO',
        icon: 'https://coin-images.coingecko.com/coins/images/29837/large/Morpho-token-icon.png',
        category: 'lending',
        confidence: 'high',
        tevStatus: 'none',
        tevRatio: 0,
        tvl: 5964542718,
        note: 'No protocol fees - governance only'
      },
      sky: {
        name: 'Sky',
        ticker: 'MKR',
        icon: 'https://coin-images.coingecko.com/coins/images/1364/large/Mark_Maker.png',
        category: 'lending',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.70,
        tvl: 5200000000,
      },
      uniswap: {
        name: 'Uniswap',
        ticker: 'UNI',
        icon: 'https://coin-images.coingecko.com/coins/images/12504/large/uniswap-logo.png',
        category: 'dex',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 1.0,
        tvl: 4500000000,
        note: '100% fee burn via Firepit + Unichain sequencer'
      },
      justlend: {
        name: 'JustLend',
        ticker: 'JST',
        icon: 'https://coin-images.coingecko.com/coins/images/11095/large/JUST.jpg',
        category: 'lending',
        confidence: 'low',
        tevStatus: 'partial',
        tevRatio: null,
        tvl: 3147428011,
        note: 'é€æ˜åº¦ä½ï¼Œå…·ä½“æ¯”ä¾‹æ— æ³•éªŒè¯'
      },
      spark: {
        name: 'Spark',
        ticker: 'SPK',
        icon: 'https://coin-images.coingecko.com/coins/images/38637/large/Spark-Logomark-RGB.png',
        category: 'lending',
        confidence: 'medium',
        tevStatus: 'none',
        tevRatio: 0,
        tvl: 4899085111,
        note: 'Revenue flows to Sky DAO'
      },
      maple: {
        name: 'Maple',
        ticker: 'SYRUP',
        icon: 'https://coin-images.coingecko.com/coins/images/51232/large/_syrup_token_logo.png',
        category: 'lending',
        confidence: 'medium',
        tevStatus: 'active',
        tevRatio: 0.25,
        tvl: 2477341241,
        note: 'SYRUP staking åˆ†çº¢ï¼ŒTEV yield ~1.18%'
      },
      pancakeswap: {
        name: 'PancakeSwap',
        ticker: 'CAKE',
        icon: 'https://coin-images.coingecko.com/coins/images/12632/large/pancakeswap-cake-logo_%281%29.png',
        category: 'dex',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.5,
        tvl: 2185582442,
      },
      kamino: {
        name: 'Kamino',
        ticker: 'KMNO',
        icon: 'https://coin-images.coingecko.com/coins/images/35801/large/Kamino_200x200.png',
        category: 'lending',
        confidence: 'high',
        tevStatus: 'none',
        tevRatio: 0,
        tvl: 1988205710,
        note: 'No TEV â€” KMNO staking is farming boost, not fee distribution'
      },
      curve: {
        name: 'Curve',
        ticker: 'CRV',
        icon: 'https://coin-images.coingecko.com/coins/images/12124/large/Curve.png',
        category: 'dex',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.50,
        tvl: 1900000000,
      },
      compound: {
        name: 'Compound',
        ticker: 'COMP',
        icon: 'https://coin-images.coingecko.com/coins/images/10775/large/COMP.png',
        category: 'lending',
        confidence: 'high',
        tevStatus: 'none',
        tevRatio: 0,
        tvl: 1442440027,
        note: 'Fee switch OFF - governance only'
      },
      jito: {
        name: 'Jito',
        ticker: 'JTO',
        icon: 'https://coin-images.coingecko.com/coins/images/33228/large/jto.png',
        category: 'liquid_staking',
        confidence: 'medium',
        tevStatus: 'none',
        tevRatio: 0,
        tvl: 1296426251,
        note: 'MEV to JitoSOL, JTO is governance'
      },
      gmx: {
        name: 'GMX',
        ticker: 'GMX',
        icon: 'https://coin-images.coingecko.com/coins/images/18323/large/arbit.png',
        category: 'perpetuals',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.30,
        tvl: 312983643,
      },
      pendle: {
        name: 'Pendle',
        ticker: 'PENDLE',
        icon: 'https://coin-images.coingecko.com/coins/images/15069/large/Pendle_Logo_Normal-03.png',
        category: 'yield',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.80,
        tvl: 300000000,
      },
      dydx: {
        name: 'dYdX',
        ticker: 'DYDX',
        icon: 'https://coin-images.coingecko.com/coins/images/32594/large/dydx.png',
        category: 'perpetuals',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.75,
        tvl: 189151204,
      },
      radiant: {
        name: 'Radiant',
        ticker: 'RDNT',
        icon: 'https://coin-images.coingecko.com/coins/images/26536/large/Radiant-Logo-200x200.png',
        category: 'lending',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.60,
        tvl: 3749741,
      },
      // CEX Tokens
      bnb: {
        name: 'BNB',
        ticker: 'BNB',
        icon: 'https://coin-images.coingecko.com/coins/images/825/large/bnb-icon2_2x.png',
        category: 'cex',
        confidence: 'low',
        tevStatus: 'active',
        tevRatio: null,
        tvl: 0,
        note: 'CEX è´¢åŠ¡ä¸å…¬å¼€ï¼Œå­£åº¦é”€æ¯ä½†æ¯”ä¾‹æœªçŸ¥'
      },
      okb: {
        name: 'OKB',
        ticker: 'OKB',
        icon: 'https://coin-images.coingecko.com/coins/images/4463/large/WeChat_Image_20220118095654.png',
        category: 'cex',
        confidence: 'low',
        tevStatus: 'active',
        tevRatio: null,
        tvl: 0,
        note: 'CEX è´¢åŠ¡ä¸å…¬å¼€ï¼Œå£°ç§°30%æ”¶å…¥ä½†æ— æ³•éªŒè¯'
      },
      bgb: {
        name: 'Bitget Token',
        ticker: 'BGB',
        icon: 'https://coin-images.coingecko.com/coins/images/11610/large/Bitget_logo.png',
        category: 'cex',
        confidence: 'low',
        tevStatus: 'active',
        tevRatio: null,
        tvl: 0,
        note: 'CEX è´¢åŠ¡ä¸å…¬å¼€ï¼Œé”€æ¯æ¯”ä¾‹æœªçŸ¥'
      },
      hype: {
        name: 'Hyperliquid',
        ticker: 'HYPE',
        icon: 'https://coin-images.coingecko.com/coins/images/50882/large/hyperliquid.jpg',
        category: 'perpetuals',
        confidence: 'high',
        tevStatus: 'active',
        tevRatio: 0.99,
        tvl: 0,
        note: '99% trading fees to buyback'
      },
      mnt: {
        name: 'Mantle',
        ticker: 'MNT',
        icon: 'https://coin-images.coingecko.com/coins/images/30980/large/MNT_Token_Logo.png',
        category: 'cex',
        confidence: 'low',
        tevStatus: 'partial',
        tevRatio: null,
        tvl: 0,
        note: 'TEV æœºåˆ¶ä¸æ˜ç¡®ï¼Œå¾…è¿›ä¸€æ­¥è°ƒç ”'
      },
      // Perpetual DEX
      aster: {
        name: 'Aster',
        ticker: 'ASTER',
        icon: 'https://coin-images.coingecko.com/coins/images/69040/large/_ASTER.png',
        category: 'perpetuals',
        confidence: 'medium',
        tevStatus: 'active',
        tevRatio: null,
        tvl: 1091092274,
        note: 'æ–°åè®®ï¼Œæ”¶å…¥æ•°æ®ç¼ºå¤±'
      },
    };
    
    // å…¼å®¹ï¼šåˆå§‹åŒ–æ—¶ç”¨å ä½ç¬¦
    PROTOCOLS = PROTOCOLS_PLACEHOLDER;

    function formatCurrency(value, decimals = 0) {
      if (value === null || value === undefined) return 'â€”';
      if (value >= 1e9) return '$' + (value / 1e9).toFixed(2) + 'B';
      if (value >= 1e6) return '$' + (value / 1e6).toFixed(2) + 'M';
      if (value >= 1e3) return '$' + (value / 1e3).toFixed(1) + 'K';
      return '$' + value.toFixed(decimals);
    }

    function formatPercent(value) {
      if (value === null || value === undefined) return 'â€”';
      return (value * 100).toFixed(2) + '%';
    }

    function formatPrice(value) {
      if (value === null || value === undefined) return 'â€”';
      if (value >= 100) return '$' + value.toFixed(0);
      if (value >= 1) return '$' + value.toFixed(2);
      return '$' + value.toFixed(4);
    }

    async function loadProtocolData() {
      // 1. å…ˆä» all-protocols.json åŠ è½½åè®®åˆ—è¡¨
      try {
        const baseRes = await fetch('../data/all-protocols.json');
        if (baseRes.ok) {
          const baseData = await baseRes.json();
          PROTOCOLS = baseData.protocols || {};
          console.log('Loaded protocols from all-protocols.json:', Object.keys(PROTOCOLS).length);
          
          // Set data update time
          if (baseData.generated_at) {
            const updateEl = document.getElementById('data-update-time');
            const date = new Date(baseData.generated_at).toISOString().split('T')[0];
            const prefix = currentLang === 'zh' ? 'æ•°æ®æ›´æ–°: ' : 'Data updated: ';
            updateEl.textContent = prefix + date;
          }
        }
      } catch (e) {
        console.warn('Failed to load all-protocols.json, using fallback');
      }
      
      // 2. å¹¶è¡ŒåŠ è½½æ¯ä¸ªåè®®çš„ latest.json è¡¥å……æ•°æ®
      const entries = Object.entries(PROTOCOLS);
      const promises = entries.map(async ([key, config]) => {
        try {
          const response = await fetch(`../data/daily/${key}/latest.json`);
          if (!response.ok) throw new Error(`HTTP ${response.status}`);
          const data = await response.json();
          return { key, ...config, ...data };
        } catch (error) {
          console.error(`Failed to load ${key}:`, error);
          return { key, ...config, error: true };
        }
      });
      
      return Promise.all(promises);
    }

    async function calculate30dTotals(protocolKey) {
      try {
        const now = new Date();
        const currentMonth = now.toISOString().slice(0, 7);
        const lastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1).toISOString().slice(0, 7);
        
        let records = [];
        
        for (const month of [lastMonth, currentMonth]) {
          try {
            const response = await fetch(`../data/daily/${protocolKey}/${month}.json`);
            if (response.ok) {
              const data = await response.json();
              records = records.concat(data.records || []);
            }
          } catch (e) {}
        }
        
        const thirtyDaysAgo = new Date(now);
        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
        
        const last30 = records.filter(r => new Date(r.date) >= thirtyDaysAgo);
        
        const totalFees = last30.reduce((sum, r) => sum + (r.daily_fees_usd || 0), 0);
        const totalTev = last30.reduce((sum, r) => sum + (r.daily_tev_usd || 0), 0);
        
        return { totalFees, totalTev };
      } catch (error) {
        console.error(`Failed to calculate 30d totals for ${protocolKey}:`, error);
        return { totalFees: 0, totalTev: 0 };
      }
    }

    // â”€â”€ æ’åºçŠ¶æ€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let currentSort = { field: 'tevStatus', dir: 'desc' }; // é»˜è®¤: TEVçŠ¶æ€é™åº (active > partial > none)
    let currentFilter = 'all';

    // TEV çŠ¶æ€æ’åºæƒé‡
    const TEV_STATUS_ORDER = { active: 3, partial: 2, none: 1 };

    function getSortValue(protocol, field) {
      switch (field) {
        case 'tvl': return protocol.tvl || 0;
        case 'tevStatus': return TEV_STATUS_ORDER[protocol.tevStatus] || 0;
        case 'tevRatio': return protocol.tevRatio || 0;
        case 'mcap': return protocol.latest_record?.market_cap_usd || 0;
        case 'earningYield': {
          const mcap = protocol.latest_record?.market_cap_usd || protocol.metrics?.current_market_cap_usd || 0;
          const annualTev = (protocol.metrics?.trailing_30d_tev_usd || 0) * 12;
          return mcap > 0 ? annualTev / mcap : 0;
        }
        case 'tevYield': return protocol.metrics?.tev_yield_decimal || 0;
        default: return 0;
      }
    }

    function sortProtocols(protocols, field, dir) {
      const sorted = [...protocols];
      sorted.sort((a, b) => {
        let valA = getSortValue(a, field);
        let valB = getSortValue(b, field);
        let cmp = valB - valA; // é»˜è®¤é™åº
        if (dir === 'asc') cmp = -cmp;
        // ç›¸åŒæ—¶æŒ‰å¸‚å€¼äºŒçº§æ’åºï¼ˆTEVçŠ¶æ€æ’åºæ—¶ç‰¹åˆ«é‡è¦ï¼‰
        if (cmp === 0) {
          const mcapA = a.latest_record?.market_cap_usd || a.metrics?.current_market_cap_usd || 0;
          const mcapB = b.latest_record?.market_cap_usd || b.metrics?.current_market_cap_usd || 0;
          cmp = mcapB - mcapA;
        }
        return cmp;
      });
      return sorted;
    }

    function updateSortIndicators() {
      document.querySelectorAll('th.sortable').forEach(th => {
        th.classList.remove('sorted', 'asc', 'desc');
        const text = th.getAttribute('data-i18n');
        // æ›´æ–° i18n æ–‡æœ¬ï¼ˆå»æ‰ç®­å¤´ï¼‰
        th.textContent = t(text);
      });
      const active = document.querySelector(`th[data-sort="${currentSort.field}"]`);
      if (active) {
        active.classList.add('sorted', currentSort.dir);
      }
    }

    function renderTable(protocols, filter = 'all', sortField = null, sortDir = null) {
      const tbody = document.getElementById('protocol-tbody');
      tbody.innerHTML = '';
      
      // æ›´æ–°è¿‡æ»¤å™¨çŠ¶æ€
      currentFilter = filter;
      
      // åº”ç”¨è¿‡æ»¤
      let filtered = protocols;
      if (filter !== 'all') {
        if (filter === 'active') {
          filtered = protocols.filter(p => p.tevStatus === 'active');
        } else if (filter === 'none') {
          filtered = protocols.filter(p => p.tevStatus === 'none');
        } else if (filter === 'cex') {
          filtered = protocols.filter(p => p.category === 'cex');
        } else if (filter === 'perpetuals') {
          filtered = protocols.filter(p => p.category === 'perpetuals');
        } else {
          filtered = protocols.filter(p => p.category === filter);
        }
      }
      
      // åº”ç”¨æ’åº
      if (sortField) {
        currentSort.field = sortField;
        currentSort.dir = sortDir || 'desc';
      }
      filtered = sortProtocols(filtered, currentSort.field, currentSort.dir);
      updateSortIndicators();
      
      filtered.forEach((protocol, index) => {
        const row = document.createElement('tr');
        row.onclick = () => window.location.href = `protocol.html?id=${protocol.key}`;
        
        const tevYield = protocol.metrics?.tev_yield_decimal || 0;
        const tevYieldClass = tevYield > 0.05 ? 'value-highlight' : tevYield === 0 ? 'value-zero' : '';
        const confidenceClass = protocol.confidence === 'high' ? 'badge-high' : 
                               protocol.confidence === 'medium' ? 'badge-medium' : 'badge-low';
        const confidenceText = t(`confidence.${protocol.confidence}`);
        
        // TEV Status badge
        const tevStatus = protocol.tevStatus || 'none';
        const tevStatusClass = tevStatus === 'active' ? 'badge-active' : 
                               tevStatus === 'partial' ? 'badge-partial' : 'badge-none';
        const tevStatusText = t(`tevStatus.${tevStatus}`);
        const tevStatusIcon = tevStatus === 'active' ? 'âœ“' : tevStatus === 'partial' ? '~' : 'âœ—';
        
        // TEV Ratio display
        const tevRatio = protocol.tevRatio || 0;
        const tevRatioText = tevRatio > 0 ? `${(tevRatio * 100).toFixed(0)}%` : 'â€”';
        const tevRatioClass = tevRatio >= 0.5 ? 'value-highlight' : tevRatio > 0 ? '' : 'value-zero';
        
        // Earning Yield - ä½¿ç”¨ TEV æ•°æ®ï¼ˆåˆ†ç»™æŒæœ‰è€…çš„æ”¶å…¥ï¼Œéæ€»è´¹ç”¨ï¼‰
        const mcap = protocol.latest_record?.market_cap_usd || protocol.metrics?.current_market_cap_usd || 0;
        const annualTev = (protocol.metrics?.trailing_30d_tev_usd || 0) * 12;
        const earningYield = mcap > 0 ? annualTev / mcap : 0;
        const earningYieldText = earningYield > 0 ? formatPercent(earningYield) : 'â€”';
        const earningYieldClass = earningYield > 0.1 ? 'value-highlight' : earningYield === 0 ? 'value-zero' : '';
        
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>
            <div class="protocol-cell">
              <div class="protocol-icon"><img src="${LOGO_URLS[protocol.key] || protocol.icon}" alt="${protocol.name}" loading="lazy" onerror="this.style.display='none';this.parentElement.textContent='${protocol.name.charAt(0)}'"></div>
              <div class="protocol-info">
                <span class="protocol-name">${protocol.name}</span>
                <span class="protocol-ticker">${protocol.ticker}</span>
              </div>
            </div>
          </td>
          <td class="text-right"><span class="value">${formatCurrency(protocol.tvl)}</span></td>
          <td class="text-right">
            <span class="badge ${tevStatusClass}">
              <span class="badge-icon">${tevStatusIcon}</span>
              ${tevStatusText}
            </span>
          </td>
          <td class="text-right"><span class="value ${tevRatioClass}">${tevRatioText}</span></td>
          <td class="text-right"><span class="value">${formatCurrency(mcap)}</span></td>
          <td class="text-right"><span class="value ${earningYieldClass}">${earningYieldText}</span></td>
          <td class="text-right"><span class="value ${tevYieldClass}">${formatPercent(tevYield)}</span></td>
          <td class="text-right">
            <span class="badge ${confidenceClass}">
              <span class="badge-icon">${protocol.confidence === 'high' ? 'âœ“' : '!'}</span>
              ${confidenceText}
            </span>
          </td>
        `;
        
        tbody.appendChild(row);
      });
    }

    function updateStats(protocols) {
      const validProtocols = protocols.filter(p => !p.error);
      
      document.getElementById('stat-protocols').textContent = validProtocols.length;
      
      const totalMcap = validProtocols.reduce((sum, p) => sum + (p.latest_record?.market_cap_usd || 0), 0);
      document.getElementById('stat-mcap').textContent = formatCurrency(totalMcap);
      
      const totalFees = validProtocols.reduce((sum, p) => sum + (p.trailing30dFees || 0), 0);
      document.getElementById('stat-fees').textContent = formatCurrency(totalFees);
      
      const totalTev = validProtocols.reduce((sum, p) => sum + (p.trailing30dTev || 0), 0);
      document.getElementById('stat-tev').textContent = formatCurrency(totalTev);
    }

    function updateFooter(protocols) {
      const latestUpdate = protocols
        .map(p => p.updated_at)
        .filter(Boolean)
        .sort()
        .reverse()[0];
      
      if (latestUpdate) {
        const date = new Date(latestUpdate);
        const dateStr = date.toLocaleDateString(currentLang === 'zh' ? 'zh-CN' : 'en-US', { 
          month: 'short', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit' 
        });
        document.getElementById('footer-updated').textContent = 
          t('footer.updated').replace('{date}', dateStr);
      }
    }

    async function init() {
      try {
        // Load logo URLs
        try {
          const logoRes = await fetch('../data/logo_urls.json');
          if (logoRes.ok) {
            LOGO_URLS = await logoRes.json();
          }
        } catch (e) {
          console.warn('Failed to load logo URLs, using emoji fallback');
        }

        const protocols = await loadProtocolData();
        
        // è·³è¿‡ 30 å¤©è®¡ç®—ä»¥åŠ é€ŸåŠ è½½ï¼ˆæ•°æ®å·²åœ¨ latest.json ä¸­ï¼‰
        // å¦‚éœ€å¯ç”¨ï¼Œå–æ¶ˆæ³¨é‡Šä»¥ä¸‹ä»£ç ï¼š
        // for (const protocol of protocols) {
        //   const totals = await calculate30dTotals(protocol.key);
        //   protocol.trailing30dFees = totals.totalFees;
        //   protocol.trailing30dTev = totals.totalTev;
        // }
        
        window.protocolData = protocols;
        
        document.getElementById('table-loading').style.display = 'none';
        document.getElementById('protocol-table').style.display = 'table';
        
        renderTable(protocols);
        updateStats(protocols);
        updateFooter(protocols);
        
        document.querySelectorAll('.filter-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderTable(protocols, btn.dataset.filter);
          });
        });
        
        // è¡¨å¤´æ’åºç‚¹å‡»
        document.querySelectorAll('th.sortable').forEach(th => {
          th.addEventListener('click', () => {
            const field = th.dataset.sort;
            let dir = 'desc';
            if (currentSort.field === field && currentSort.dir === 'desc') {
              dir = 'asc';
            }
            renderTable(protocols, currentFilter, field, dir);
          });
        });
        
        document.querySelectorAll('.lang-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            setLanguage(btn.dataset.lang);
          });
        });
        
      } catch (error) {
        console.error('Failed to initialize:', error);
        document.getElementById('table-loading').innerHTML = `
          <div style="color: var(--danger);">Failed to load data</div>
          <div style="margin-top: 8px; font-size: 12px;">${error.message}</div>
        `;
      }
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
